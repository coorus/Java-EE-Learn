# æ·±å…¥ AOP é€šçŸ¥ç±»å‹
![gqj](../Source/attachments/gqj.jpg)
## 1. ç¯ç»•é€šçŸ¥ï¼ˆ@Aroundï¼‰

ç¯ç»•é€šçŸ¥æ˜¯æœ€çµæ´»çš„é€šçŸ¥ç±»å‹ï¼Œå®ƒèƒ½å¤Ÿåœ¨ç›®æ ‡æ–¹æ³•çš„æ‰§è¡Œå‰åè¿›è¡Œæ“ä½œï¼Œå¹¶ä¸”å¯ä»¥åŒ…å«å…¶ä»–é€šçŸ¥çš„æ‰§è¡Œä½ç½®ã€‚

### ç¤ºä¾‹ä»£ç ï¼š

```java
@Around("execution(* io.github.coorus.section1_15.user.UserService.*(..))")  
public void around(ProceedingJoinPoint joinPoint) {  
    System.out.println((++flag) + " @Aroundå‰ç½®é€šçŸ¥");  
    try {  
        Object proceed = joinPoint.proceed(joinPoint.getArgs());  
        System.out.println((++flag) + " @Aroundè¿”å›é€šçŸ¥");  
    } catch (Throwable e) {  
        System.out.println((++flag) + " @Aroundå¼‚å¸¸é€šçŸ¥");  
        throw new RuntimeException(e);  
    } finally {  
        System.out.println((++flag) + " @Aroundåç½®é€šçŸ¥");  
    }  
}
```
##### **ğŸ’ æ–°å»ºæ–‡ä»¶ä½¿ç”¨AOPæ—¶éœ€è¦éœ€è¦å…ˆå¯¼å…¥ä¾èµ–**
```xml
<dependency>  
    <groupId>org.springframework.boot</groupId>  
    <artifactId>spring-boot-starter-aop</artifactId>  
</dependency>
```
---

## 2. å‰ç½®é€šçŸ¥ï¼ˆ@Beforeï¼‰

å‰ç½®é€šçŸ¥åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œï¼Œä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨ç›®æ ‡æ–¹æ³•ã€‚

### ç¤ºä¾‹ä»£ç ï¼š

```java
@After("execution(* io.github.coorus.section1_15.user.UserService.*(..))")  
public void after(JoinPoint joinPoint) {  
    System.out.println("åç½®é€šçŸ¥@After");  
}
```

---

## 3. åç½®é€šçŸ¥ï¼ˆ@Afterï¼‰

åç½®é€šçŸ¥æ— è®ºç›®æ ‡æ–¹æ³•æ˜¯å¦æŠ›å‡ºå¼‚å¸¸ï¼Œéƒ½ä¼šåœ¨æ–¹æ³•æ‰§è¡Œåæ‰§è¡Œï¼Œ**ç›¸å½“äº `finally` å—ä¸­çš„ä»£ç **ã€‚

### ç¤ºä¾‹ä»£ç ï¼š

```java
@After("execution(* io.github.coorus.section1_15.user.UserService.*(..))")  
public void after(JoinPoint joinPoint) {  
    System.out.println("åç½®é€šçŸ¥@After");  
}
```

---

## 4. è¿”å›é€šçŸ¥ï¼ˆ@AfterReturningï¼‰

è¿”å›é€šçŸ¥åªæœ‰åœ¨ç›®æ ‡æ–¹æ³•æ­£å¸¸æ‰§è¡Œå¹¶è¿”å›ç»“æœæ—¶æ‰ä¼šæ‰§è¡Œã€‚

### ç¤ºä¾‹ä»£ç ï¼š

```java
@AfterReturning(value = "execution(* com.gok.javaee.aop.UserService.*(..))", returning = "returnValue")
public void fun(JoinPoint joinPoint, Object returnValue) {
    String methodName = joinPoint.getSignature().getName();
    System.out.println("è¿”å›é€šçŸ¥ï¼Œç›®æ ‡æ–¹æ³•ï¼š" + methodName + "ï¼Œè¿”å›å€¼ï¼š" + returnValue);
}
```

---

## 5. å¼‚å¸¸é€šçŸ¥ï¼ˆ@AfterThrowingï¼‰

å¼‚å¸¸é€šçŸ¥åªæœ‰åœ¨ç›®æ ‡æ–¹æ³•æŠ›å‡ºå¼‚å¸¸æ—¶æ‰ä¼šæ‰§è¡Œã€‚

### ç¤ºä¾‹ä»£ç ï¼š

```java
@AfterThrowing(value = "execution(* com.gok.javaee.aop.UserService.*(..))", throwing = "ex")
public void fun(JoinPoint joinPoint, Exception ex) {
    String methodName = joinPoint.getSignature().getName();
    System.out.println("å¼‚å¸¸é€šçŸ¥ï¼Œç›®æ ‡æ–¹æ³•ï¼š" + methodName + "ï¼Œå¼‚å¸¸ä¿¡æ¯ï¼š" + ex.getMessage());
}
```

---

## 6. é€šçŸ¥æ‰§è¡Œé¡ºåº

- **æ­£å¸¸æƒ…å†µ**ï¼š  
  å‰ç½®é€šçŸ¥ --> ç›®æ ‡æ–¹æ³• --> è¿”å›é€šçŸ¥ --> åç½®é€šçŸ¥
- **å¼‚å¸¸æƒ…å†µ**ï¼š  
  å‰ç½®é€šçŸ¥ --> ç›®æ ‡æ–¹æ³• --> å¼‚å¸¸é€šçŸ¥ --> åç½®é€šçŸ¥

---

## ç»ƒä¹ ï¼š

ä½¿ç”¨ AOP çš„å‰ç½®ã€åç½®ã€è¿”å›å’Œå¼‚å¸¸é€šçŸ¥ï¼Œå¹¶éªŒè¯é€šçŸ¥çš„æ‰§è¡Œé¡ºåºã€‚