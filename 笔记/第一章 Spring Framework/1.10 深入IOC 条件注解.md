# æ·±å…¥IOC æ¡ä»¶æ³¨è§£
![gmzr](../Source/attachments/gmzr_1.png)
åŠ¨æ€å†³å®š Bean æ˜¯å¦ç”Ÿæ•ˆ
## `@ConditionalOnProperty`
`@ConditionalOnProperty` æ³¨è§£ç”¨äºæ ¹æ®é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§å€¼åŠ¨æ€å†³å®šæŸä¸ª Bean æ˜¯å¦ç”Ÿæ•ˆã€‚

- **å±æ€§è§£é‡Š**ï¼š
  - `value`ï¼šæŒ‡å®šé…ç½®é¡¹çš„ keyã€‚
  - `havingValue`ï¼šæŒ‡å®šé…ç½®é¡¹çš„å€¼ï¼Œå½“é…ç½®é¡¹çš„å€¼ä¸è¯¥å€¼åŒ¹é…æ—¶ï¼ŒBean ç”Ÿæ•ˆã€‚
  - `matchIfMissing`ï¼šå¦‚æœé…ç½®é¡¹ä¸å­˜åœ¨ï¼Œæ˜¯å¦ä½¿ Bean ç”Ÿæ•ˆï¼Œé»˜è®¤ä¸º `false`ã€‚

```properties
# application.properties
cpu.type=cpuA
```

```java
// Config.java
@Configuration
public class Config {

    @Bean
    //å½“é…ç½®cpu.typeç­‰äºcpuAæ—¶ï¼Œbeanç”Ÿæ•ˆï¼ˆå¦‚æœé…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰cpu.typeä¹Ÿç”Ÿæ•ˆï¼‰
    @ConditionalOnProperty(value = "cpu.type", havingValue = "cpuA", matchIfMissing = true)
    public ICpu cpuA() {
        return new CpuA();
    }

    @Bean
    //å½“é…ç½®cpu.typeç­‰äºcpuBæ—¶ï¼Œbeanç”Ÿæ•ˆï¼ˆå¦‚æœé…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰cpu.typeä¸ç”Ÿæ•ˆï¼‰
    @ConditionalOnProperty(value = "cpu.type", havingValue = "cpuB")
    public ICpu cpuB() {
        return new CpuB();
    }
}
```

- **ç¤ºä¾‹è¯´æ˜**ï¼š
  1. å¦‚æœ `cpu.type=cpuB`ï¼Œåˆ™ç”Ÿæˆ `cpuB`ã€‚
  2. å¦‚æœ `application.properties` ä¸­æ²¡æœ‰ `cpu.type` çš„é…ç½®ï¼Œåˆ™ç”Ÿæˆ `cpuA`ã€‚
  3. å¦‚æœ `cpu.type` ä¸ºç©ºæˆ–ç­‰äº `cpuA`ï¼Œåˆ™ç”Ÿæˆ `cpuA`ã€‚

##### ä½¿ç”¨ `@Component` + `@ConditionalOnProperty` å®ç°ä¸Šè¿°åŠŸèƒ½ã€‚
```properties
// application.properties  
cpu.type=cpuA
```
```java
// CpuA.java  
@Component  
@ConditionalOnProperty(value = "cpu.type", havingValue = "cpuA", matchIfMissing = true)  
public class CpuA implements ICpu{  
}
```

## `@ConditionalOnClass` / `@ConditionalOnMissingClass`
- **ä½œç”¨**ï¼šå½“é¡¹ç›®ä¸­åŒ…å«æˆ–ä¸åŒ…å«æŸä¸ªç±»æ—¶ï¼Œå†³å®š Bean æ˜¯å¦ç”Ÿæ•ˆã€‚

```java
// Config.java
@Configuration
public class Config {

    @Bean
    @ConditionalOnClass(name = "java.util.List")
    public ICpu cpuA() {
        return new CpuA();
    }
}
```

  * ğŸ’   **åº”ç”¨åœºæ™¯**ï¼šé€šè¿‡åˆ¤æ–­æ˜¯å¦å¯¼å…¥äº†æŸä¸ªæ•°æ®åº“é©±åŠ¨ç±»ï¼Œç”Ÿæˆå¯¹åº”çš„æ•°æ®åº“è¿æ¥ Beanã€‚

## `@ConditionalOnBean` / `@ConditionalOnMissingBean`
- **ä½œç”¨**ï¼šå½“å®¹å™¨ä¸­å­˜åœ¨æˆ–ä¸å­˜åœ¨æŒ‡å®šçš„ Bean æ—¶ï¼Œå†³å®šå¦ä¸€ä¸ª Bean æ˜¯å¦ç”Ÿæ•ˆã€‚

```java
// Config.java
@Configuration
public class Config {

    @Bean
    public ICpu cpuA() {
        return new CpuA();
    }

    @Bean
    public IMemory memoryA() {
        return new MemoryA();
    }

    @Bean
    public IMemory memoryB() {
        return new MemoryB();
    }

    @Bean
    @ConditionalOnBean(name = {"cpuA", "memoryA", "memoryB"})
    public Computer computer(ICpu cpuA, List<IMemory> memory) {
        return new Computer(cpuA, memory);
    }
}
```

 * ğŸ’   **åº”ç”¨åœºæ™¯**ï¼šå½“å®¹å™¨ä¸­å·²ç»å­˜åœ¨æŸäº›ç‰¹å®šçš„ Bean æ—¶ï¼Œè‡ªåŠ¨é…ç½®å¦ä¸€ä¸ªä¾èµ–è¿™äº› Bean çš„å¯¹è±¡ã€‚